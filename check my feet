

// 足元を調べたい
let player_x = $gamePlayer.x;
let player_y = $gamePlayer.y;

let targetX = player_x;
let targetY = player_y;

switch ($gamePlayer.direction()) {
    case 2: // 下を向いている
        targetY += 1;
        break;
    case 4: // 左を向いている
        targetX -= 1;
        break;
    case 6: // 右を向いている
        targetX += 1;
        break;
    case 8: // 上を向いている
        targetY -= 1;
        break;
    default:
        // その他の方向（通常はあり得ないが、念のため）
        break;
}

let events = $gameMap.eventsXy(targetX, targetY);

if (events.length > 0) {
    // 対象のタイルにイベントがある場合
    let foundVillager = false;
    for (let i = 0; i < events.length; i++) {
        if (events[i].event().note.includes("村人")) {
            // イベントのメモに"村人"が含まれている場合
　　　　　　$gameMap.event(events[i].eventId()).start();
            foundVillager = true;
            break;
        }
    }
    if ( !foundVillager ) {
        $gameSwitches.setValue(6, true);
    }
} else {
    $gameSwitches.setValue(6, true);
}
